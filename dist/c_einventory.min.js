'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(g,h,f){if(g==Array.prototype||g==Object.prototype)return g;g[h]=f.value;return g};
$jscomp.getGlobal=function(g){g=["object"==typeof globalThis&&globalThis,g,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var h=0;h<g.length;++h){var f=g[h];if(f&&f.Math==Math)return f}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(g,h){var f=$jscomp.propertyToPolyfillSymbol[h];if(null==f)return g[h];f=g[f];return void 0!==f?f:g[h]};$jscomp.polyfill=function(g,h,f,l){h&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(g,h,f,l):$jscomp.polyfillUnisolated(g,h,f,l))};
$jscomp.polyfillUnisolated=function(g,h,f,l){f=$jscomp.global;g=g.split(".");for(l=0;l<g.length-1;l++){var k=g[l];if(!(k in f))return;f=f[k]}g=g[g.length-1];l=f[g];h=h(l);h!=l&&null!=h&&$jscomp.defineProperty(f,g,{configurable:!0,writable:!0,value:h})};
$jscomp.polyfillIsolated=function(g,h,f,l){var k=g.split(".");g=1===k.length;l=k[0];l=!g&&l in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var q=0;q<k.length-1;q++){var p=k[q];if(!(p in l))return;l=l[p]}k=k[k.length-1];f=$jscomp.IS_SYMBOL_NATIVE&&"es6"===f?l[k]:null;h=h(f);null!=h&&(g?$jscomp.defineProperty($jscomp.polyfills,k,{configurable:!0,writable:!0,value:h}):h!==f&&($jscomp.propertyToPolyfillSymbol[k]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(k):$jscomp.POLYFILL_PREFIX+k,k=
$jscomp.propertyToPolyfillSymbol[k],$jscomp.defineProperty(l,k,{configurable:!0,writable:!0,value:h})))};$jscomp.polyfill("globalThis",function(g){return g||$jscomp.global},"es_2020","es3");
(()=>{const g=setInterval(()=>{VYLO.Client&&(clearInterval(g),h())}),h=()=>{const f={};globalThis.EInventory=f;VYLO.Client.addWebStyle("EInventory_input",".EInventory_modal{display:none;position:fixed;font-family:Arial;z-index:999999;padding-top:100px;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgb(0,0,0);background-color:rgba(0,0,0,.4);user-select:none}.EInventory_modalContent{background-color:#fefefe;margin:auto;padding:20px;border:1px solid #888;border-radius:20px;width:15%}.EInventory_modalInput{width:100%}.EInventory_modalClose{color:#aaa;float:right;font-size:28px;font-weight:700}.EInventory_modalClose:hover,.EInventory_modalClose:focus{color:#000;text-decoration:none;cursor:pointer}.EInventory_animateZoom{animation:EInventory_animatezoom 0.3s}@keyframes EInventory_animatezoom{from{transform:scale(0)}to{transform:scale(1)}}");VYLO.Client.createInterface("EInventory_input_interface");
const l=VYLO.Client.getWindowSize(),k=VYLO.newDiob("Interface");k.interfaceType="WebBox";k.width=l.width;k.height=l.height;k.mouseOpacity=0;k.touchOpacity=0;k.preventAutoScale=!0;VYLO.Client.addInterfaceElement(k,"EInventory_input_interface","EInventory_input",0,0);k.text='<div class=EInventory_modal id=EInventory_modal><div class="EInventory_animateZoom EInventory_modalContent"><span class=EInventory_modalClose id=EInventory_modalClose>\u00d7</span><p id=EInventory_modalTitleContent>Drop how many?<form><div><input class=EInventory_modalInput id=EInventory_modalInput min="0" placeholder="1" type="number" value="1"><p><button id=EInventory_submit type=button>Ok</button></div></form></div></div>';
VYLO.Client.showInterface("EInventory_input_interface");VYLO.global.EInventory=f;f.storedSlotTypes={};f.storedInventories={};f.highlightSlot=function(a){this.slotHighlight&&(a.getOverlays().includes(this.slotHighlight)||a.addOverlay(this.slotHighlight))};f.unhighlightSlot=function(a){a.getOverlays().includes(this.slotHighlight)&&a.removeOverlay(this.slotHighlight,!0)};class q{constructor(a){this._slotNumber=a;this._slotElement=null;this._item={};this._overlay=VYLO.newDiob("Overlay");this._overlay.touchOpacity=
0;this._overlay.mouseOpacity=0;this._overlay.appearMask={ownState:!0,ownAnim:!0,ownMod:!0};this._overlay.animator={sync:"EInventory_overlay_sync"};this._overlay.preventAutoScale=!0}getItemInfo(){return this._item.itemInfo?this._item.itemInfo:null}getItemQuantity(){return this._item.quantity?this._item.quantity:0}getItemType(){return this._item.type?this._item.type:null}getItem(){return this.hasItem()?JSON.parse(JSON.stringify(this._item)):null}get item(){return this.hasItem()?JSON.parse(JSON.stringify(this._item)):
null}getSlotNumber(){return this._slotNumber}get slotNumber(){return this._slotNumber}getParent(){return this._parent}get parent(){return this._parent}hasItem(){return this.getItemType()?!0:!1}hideInfo(){this._overlay.atlasName="";this._overlay.iconName="";this._slotElement.text=""}refresh(){const a=this.getItemType(),b=this.getItemQuantity();this._overlay.atlasName=a?VYLO.Type.getVariable(a,"atlasName"):"";this._overlay.iconName=a?(VYLO.Type.getVariable(a,"iconState")?VYLO.Type.getVariable(a,"iconState"):
VYLO.Type.getVariable(a,"iconName"))+this.getParent()._denotar:"";this._slotElement.text=b?'<div class="'+this.getParent()._slotClassList.join(" ")+'"><sub>'+b+"</sub></div>":""}wipe(){for(const a in this._item)delete this._item[a]}}class p{constructor(a){this._interface=a.interface;this._itemAtlasName=a.itemAtlasName;this._global=a.global;this._maxSlots=a.maxSlots;this._maxDistance=a.maxDistance;this._slotClassList=a.slotClassList;this._slotType=a.slotType;this._denotar=a.denotar;this._id=a.id;this._disableDefaultDrop=
a.disableDefaultDrop;this._slots={};this._registeredTypes=[...a.registeredTypes];this._locked=!1;this.generateSlots(this._maxSlots)}dropIsDisabled(){return this._disableDefaultDrop}getMaxDistance(){return this._maxDistance}getSlot(a){return this._slots[a]?this._slots[a]:void 0}getID(){return this._id}getStorage(){const a={};for(let b=0;b<this._maxSlots;b++)a[b]=this.getSlot(b)._item;return a}get storage(){return this.getStorage()}generateSlots(a){const b=VYLO.Type.getVariable(this._slotType,"width"),
c=VYLO.Type.getVariable(this._slotType,"height");for(let e=0;e<a;e++){const d=VYLO.Client.getInterfaceElement(this._interface,"slot_"+(e+1));this._slots[e]=new q(e);const m=this._slots[e]._overlay;m.width=b;m.height=c;this._slots[e]._parent=this;this._slots[e]._slotElement=d;d.addOverlay(m);d.slotInstance=this._slots[e]}}isGlobal(){return this._global}isMaxed(){let a=!0;for(let b=0;b<this._maxSlots;b++)if(!this.getSlot(b).hasItem()){a=!1;break}return a}getOpenSlot(){let a;for(let b=0;b<this._maxSlots;b++)if(!this.getSlot(b).hasItem()){a=
b;break}return a}registerType(a){VYLO.Type.isType(a)?this._registeredTypes.includes(a)||this._registeredTypes.push(a):console.warn("EInventory: This is not a valid type. Registration failed")}unRegisterType(a){this._registeredTypes.includes(a)&&this._registeredTypes.splice(this._registeredTypes.indexOf(a),1)}isLocked(){return this._locked}lock(){this._locked=!0}unlock(){this._locked=!1}static addItemToMap(a,b,c,e,d,m){a=VYLO.newDiob(a);d&&(a.itemInfo=d);m&&(a.quantity=m);a.setPos(b,c,e);if("function"===
typeof a.onDropped)a.onDropped()}static removeItemFromMap(a){if("function"===typeof a.onPickup)a.onPickup();VYLO.delDiob(a)}static authenticateItemRequest(a,b){if("function"===typeof VYLO.Client.onNetwork)VYLO.Client.onNetwork("EInventory","authenticateItemRequest",[[a,b]])}isEligibleType(a){let b=!1;for(const c of this._registeredTypes)if(VYLO.Type.isType(a,c)){b=!0;break}return this._registeredTypes.includes(a)||b?!0:(console.error("EInventory: This type("+a+") is not of a registered type with this inventory."),
!1)}isEligibleItem(a){if(a){if("local"===VYLO.World.getCodeType()&&!(a.obtainable||(VYLO.Type.getVariable(type,"obtainable")?VYLO.Type.getVariable(type,"obtainable"):VYLO.Type.getStaticVariable(type,"obtainable"))))return console.error("EInventory: This item("+a.id+") is not obtainable."),!1;if(!this.isEligibleType(a.type))return!1;if("local"===VYLO.World.getCodeType()&&this.isMaxed()&&!a.quantity)return console.error("EInventory: %cpNo available slots","font-weight: bold"),!1;if(VYLO.Map.getDist(VYLO.Client.mob,
a)>this.getMaxDistance())return console.error("EInventory: This item("+a.id+") is out of range."),!1}else return console.error("EInventory: No item passed!"),!1;return!0}obtain(a){a&&VYLO.World.getDiobByID(a.id)&&("client"===VYLO.World.getCodeType()?this.isEligibleItem(a)&&p.authenticateItemRequest(this.getID(),a.id):this.isEligibleItem(a)&&this.addItem(a))}restoreSlot(a){this.isLocked()||this.getSlot(a).refresh();this._activeSlotNumber=null}addItemFromServer(a,b){const c=a[0],e=a[1];a=a[2];let d;
c&&(d=VYLO.World.getDiobByID(c).type);this.getSlot(b)._item.type=d;e&&(this.getSlot(b)._item.quantity=e);a&&(this.getSlot(b)._item.itemInfo=a);this.getSlot(b).refresh()}addItem(a){if(this.isLocked())console.warn("EInventory: This inventory is currently locked. Unlock it to pick up this item");else{var b=a.type,c=a.quantity,e=a.itemInfo?a.itemInfo:VYLO.Type.getVariable(b,"itemInfo")?VYLO.Type.getVariable(b,"itemInfo"):VYLO.Type.getStaticVariable(b,"itemInfo");for(var d in this._slots)if(this.getSlot(d).getItemType()===
b){const m=this.getSlot(d).getItemQuantity();if(c){const n=a.maxQuantity?a.maxQuantity:VYLO.Type.getVariable(b,"maxQuantity")?VYLO.Type.getVariable(b,"maxQuantity"):VYLO.Type.getStaticVariable(b,"maxQuantity")?VYLO.Type.getStaticVariable(b,"maxQuantity"):1;if(m!==n){m+c>n?(b=Math.max(m+c-n,1),this.getSlot(d)._item.quantity=Math.max(m,Math.min(m+c,n)),e&&(this.getSlot(d)._item.itemInfo=e),this.getSlot(d).refresh(),a.quantity=b,this.addItem(a)):(this.getSlot(d)._item.quantity=Math.max(m,Math.min(m+
c,n)),e&&(this.getSlot(d)._item.itemInfo=e),this.getSlot(d).refresh(),p.removeItemFromMap(a));return}}}this.isMaxed()?console.error("EInventory: %cpNo available slots","font-weight: bold"):(d=this.getOpenSlot(),b={type:b},c&&(b.quantity=c),e&&(b.itemInfo=e),this.getSlot(d)._item=b,this.getSlot(d).refresh(),p.removeItemFromMap(a))}}discardQuantity(a,b){const c=this.getSlot(a).getItemQuantity();!c&&!b||!c||b>=c?this.getSlot(a).wipe():this.getSlot(a)._item.quantity=Math.max(c-b,1);this.getSlot(a).refresh()}removeQuantity(a,
b){if(this.getSlot(a).getItemQuantity())if("local"===VYLO.World.getCodeType())this.discardQuantity(a,b);else if("function"===typeof VYLO.Client.onNetwork)VYLO.Client.onNetwork("EInventory","removeQuantity",[[this.getID(),a,b]])}removeQuantityFromServer(a,b){this.discardQuantity(a,b)}removeItem(a,b){if(this.isLocked())console.warn("EInventory: This inventory is currently locked. Unlock it to remove this item");else if(this.getSlot(a))if(this.getSlot(a).hasItem()){var c=this.getSlot(a).getItemQuantity();
if(!(c&!b))if(b=Math.max(c?1:0,Math.min(b,c)),"local"===VYLO.World.getCodeType()){const e=this.getSlot(a).getItemType(),d=this.getSlot(a).getItemInfo();c=Math.max(c?1:0,Math.min(c?b:0,c));(VYLO.Type.getVariable(e,"dissapearOnDrop")?VYLO.Type.getVariable(e,"dissapearOnDrop"):VYLO.Type.getStaticVariable(e,"dissapearOnDrop"))||p.addItemToMap(e,VYLO.Client.mob.xPos,VYLO.Client.mob.yPos,VYLO.Client.mob.mapName,d,c);this.discardQuantity(a,b)}else if("function"===typeof VYLO.Client.onNetwork)VYLO.Client.onNetwork("EInventory",
"removeItem",[[this.getID(),a,b]])}else console.error("EInventory: No item in slot("+a+")");else console.error("EInventory: This is not a valid slot("+a+")")}removeItemFromServer(a,b){this.discardQuantity(a,b)}relinquish(a,b){if(this.isLocked())console.warn("EInventory: This inventory is currently locked. Unlock it to remove this item");else if(this.getSlot(a))if(this.getSlot(a).hasItem()){let c=1;const e=this.getSlot(a).getItemQuantity();1<e?(this.lock(),this._activeSlotNumber=a,f.input.call(this,
"Amount to drop?",function(d){d=parseInt(d,10);d=Number.isInteger(d)?d:1;c=Math.max(0,Math.min(d,e));!c&&e?(this.unlock(),this.restoreSlot(a)):1<=c?(this.unlock(),0<e-c&&this.restoreSlot(a),this.removeItem(a,c)):(this.unlock(),this.restoreSlot(a))}.bind(this))):this.removeItem(a,e)}else console.error("EInventory: No item in slot("+a+")");else console.error("EInventory: This is not a valid slot("+a+")")}moveSlot(a,b){if(!this.isLocked()){const c=b.getParent();if(c.isEligibleType(a.getItemType())){const e=
a.getItem();a.wipe();b._item=e;a.refresh();b.refresh();if("function"===typeof VYLO.Client.onNetwork)VYLO.Client.onNetwork("EInventory","moveSlot",[[this.getID(),c.getID(),a.getSlotNumber(),b.getSlotNumber()]])}else this.restoreSlot(a.getSlotNumber())}}swapSlots(a,b){if(!this.isLocked()){const c=b.getParent();if(this.isEligibleType(b.getItemType())&&c.isEligibleType(a.getItemType())){const e=a.getItem(),d=b.getItem();a._item=d;b._item=e;a.refresh();b.refresh();if("function"===typeof VYLO.Client.onNetwork)VYLO.Client.onNetwork("EInventory",
"swapSlots",[[this.getID(),c.getID(),a.getSlotNumber(),b.getSlotNumber()]])}else this.restoreSlot(a.getSlotNumber()),c.restoreSlot(b.getSlotNumber())}}}f.createInventoryFromServer=function(a,b,c,e,d,m,n,r,t,u,v,w){VYLO.Client[v]=this.createInventory({"interface":a,itemAtlasName:b,slotType:c,global:e,maxSlots:d,maxDistance:m,slotClassList:n,registeredTypes:r,denotar:t,disableDefaultDrop:w,id:u})};f.input=function(a="Drop how many?",b){const c=document.getElementById("EInventory_modal"),e=document.getElementById("EInventory_modalInput"),
d=document.getElementById("EInventory_modalClose"),m=document.getElementById("EInventory_submit"),n=document.getElementById("EInventory_modalTitleContent");c.initialized||(c.show=function(){this.style.display="block"},c.hide=function(){this.style.display="none";this.inventory.unlock();this.inventory.restoreSlot(this.inventory._activeSlotNumber);this.inventory=null;e.value=1},c.close=function(){"function"===typeof this.callback&&this.callback(parseInt(e.value,10));this.callback=null;e.value=1},m.addEventListener("click",
function(r){c.close();c.style.display="none"}),d.addEventListener("click",function(r){c.hide()}),window.addEventListener("click",function(r){r.target===c&&c.hide()}),c.initialized=!0);n.textContent=a;c.callback=b;c.inventory=this;e.setAttribute("max",c.inventory._slots[c.inventory._activeSlotNumber].getItemQuantity());c.show()};f.createInventory=function(a){if("object"===typeof a&&a.constructor===Object)if(a.interface)if(VYLO.Client.getInterfaceNames().includes(a.interface))if(a.itemAtlasName)if("string"!==
typeof a.slotType)console.error("EInventory: The pSettings.slotType is of the wrong type. Expecting a string. Initialization failed.");else{if(a.slotType){a.global&&(a.global=!0);a.disableDefaultDrop&&(a.disableDefaultDrop=!0);a.denotar||(a.denotar="_gui");a.maxSlots="number"!==typeof a.maxSlots?20:Math.round(a.maxSlots);a.maxDistance="number"!==typeof a.maxDistance?48:Math.round(a.maxDistance);Array.isArray(a.slotClassList)||(a.slotClassList=[],console.error("EInventory: The pSettings.slotClassList is not of the Array type."));
Array.isArray(a.registeredTypes)||(a.registeredTypes=[],console.warn("EInventory: This inventory has no registered types to accept. It will not be able to store anything until a type is registered!"));var b=new p(a);this.storedSlotTypes[a.slotType]=b;a.id&&(this.storedInventories[a.id]=b);var c=VYLO.Type.getVariable(a.slotType,"width");a=VYLO.Type.getVariable(a.slotType,"height");this.slotHighlight=VYLO.newDiob("Overlay");this.slotHighlight.width=c;this.slotHighlight.height=a;this.slotHighlight.preventAutoScale=
!0;this.slotHighlight.mouseOpacity=0;this.slotHighlight.touchOpacity=0;this.slotHighlight.atlasName="";this.slotHighlight.iconName="";this.slotHighlight.alpha=.1;this.slotHighlight.color={tint:16777215};return b}console.error("EInventory: pSettings.slotType was found! This is a needed property")}else console.error("EInventory: The pSettings.itemAtlasName string could not be found. Initialization failed.");else console.error("EInventory: The pSettings.interface interface could not be found. Initialization failed.");
else console.error("EInventory: The pSettings.interface string could not be found. Initialization failed.");else console.warn("EInventory: Invalid type passed for pSettings")};f.handleOnMouseDown=function(a,b,c,e){1===e&&(b=this.storedSlotTypes[a.type],a&&b&&!b.isLocked()&&(a=a.slotInstance,a.hasItem()&&(this.heldSlotInstance=a,this.grabbing=!0,this.mouseCursor||(this.mouseCursor=VYLO.newDiob()),this.mouseCursor.atlasName=VYLO.Type.getVariable(a.getItemType(),"atlasName"),this.mouseCursor.iconName=
VYLO.Type.getVariable(a.getItemType(),"iconName"),this.mouseCursor.iconState=VYLO.Type.getVariable(a.getItemType(),"iconState"),VYLO.Client.setMouseCursor(this.mouseCursor),a.hideInfo())))};f.handleOnMouseUp=function(a,b,c,e){if(1===e&&this.heldSlotInstance){b=this.heldSlotInstance.getParent();let d;a?(c=this.storedSlotTypes[a.type],d=a.slotInstance,a.mapName&&"Interface"!==a.baseType?b.dropIsDisabled()||b.relinquish(this.heldSlotInstance.getSlotNumber()):this.heldSlotInstance===d?b.restoreSlot(this.heldSlotInstance.getSlotNumber()):
d&&b===c?d.hasItem()?b.swapSlots(this.heldSlotInstance,d):b.moveSlot(this.heldSlotInstance,d):d&&b!==c?c.isGlobal()?d.hasItem()?b.isGlobal()?b.swapSlots(this.heldSlotInstance,d):b.restoreSlot(this.heldSlotInstance.getSlotNumber()):b.moveSlot(this.heldSlotInstance,d):b.restoreSlot(this.heldSlotInstance.getSlotNumber()):"Interface"===a.baseType&&b.restoreSlot(this.heldSlotInstance.getSlotNumber())):b.dropIsDisabled()||b.relinquish(this.heldSlotInstance.getSlotNumber());this.heldSlotInstance.refresh();
this.heldSlotInstance=null;d&&d.refresh();this.grabbing=!1;VYLO.Client.setMouseCursor("")}};f.getInventoryByID=function(a){return this.storedInventories[a]};f.isHoldingItem=function(){return this.grabbing?!0:!1};f.toggleDebug=function(){this.debugging=!this.debugging};EListener.on(VYLO.Client,"onMouseDown",f.handleOnMouseDown.bind(f));EListener.on(VYLO.Client,"onMouseUp",f.handleOnMouseUp.bind(f))}})();