'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,f,e){if(c==Array.prototype||c==Object.prototype)return c;c[f]=e.value;return c};
$jscomp.getGlobal=function(c){c=["object"==typeof globalThis&&globalThis,c,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var f=0;f<c.length;++f){var e=c[f];if(e&&e.Math==Math)return e}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(c,f){var e=$jscomp.propertyToPolyfillSymbol[f];if(null==e)return c[f];e=c[e];return void 0!==e?e:c[f]};$jscomp.polyfill=function(c,f,e,a){f&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(c,f,e,a):$jscomp.polyfillUnisolated(c,f,e,a))};
$jscomp.polyfillUnisolated=function(c,f,e,a){e=$jscomp.global;c=c.split(".");for(a=0;a<c.length-1;a++){var b=c[a];if(!(b in e))return;e=e[b]}c=c[c.length-1];a=e[c];f=f(a);f!=a&&null!=f&&$jscomp.defineProperty(e,c,{configurable:!0,writable:!0,value:f})};
$jscomp.polyfillIsolated=function(c,f,e,a){var b=c.split(".");c=1===b.length;a=b[0];a=!c&&a in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var d=0;d<b.length-1;d++){var g=b[d];if(!(g in a))return;a=a[g]}b=b[b.length-1];e=$jscomp.IS_SYMBOL_NATIVE&&"es6"===e?a[b]:null;f=f(e);null!=f&&(c?$jscomp.defineProperty($jscomp.polyfills,b,{configurable:!0,writable:!0,value:f}):f!==e&&($jscomp.propertyToPolyfillSymbol[b]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(b):$jscomp.POLYFILL_PREFIX+b,b=
$jscomp.propertyToPolyfillSymbol[b],$jscomp.defineProperty(a,b,{configurable:!0,writable:!0,value:f})))};$jscomp.polyfill("globalThis",function(c){return c||$jscomp.global},"es_2020","es3");
(()=>{const c={};VYLO.global.EInventory=c;globalThis.EInventory=c;c.storedSlotTypes={};c.storedInventories={};c.storedIDs=[];class f{constructor(a){this._slotNumber=a;this._slotElement=null;this._item={}}getItemInfo(){return this._item.itemInfo?this._item.itemInfo:null}getItemQuantity(){return this._item.quantity?this._item.quantity:0}getItemType(){return this._item.type?this._item.type:null}getItem(){return this.hasItem()?JSON.parse(JSON.stringify(this._item)):null}get item(){return this.hasItem()?
JSON.parse(JSON.stringify(this._item)):null}getSlotNumber(){return this._slotNumber}get slotNumber(){return this._slotNumber}getParent(){return this._parent}get parent(){return this._parent}hasItem(){return this.getItemType()?!0:!1}wipe(){for(const a in this._item)delete this._item[a]}}class e{constructor(a){this._interface=a.interface;this._itemAtlasName=a.itemAtlasName;this._global=a.global;this._maxSlots=a.maxSlots;this._maxDistance=a.maxDistance;this._slotClassList=a.slotClassList;this._slotType=
a.slotType;this._denotar=a.denotar;this._sendItemInfo=a.sendItemInfo;this._client=a.client;this._id=a.id;this._slots={};this._registeredTypes=[...a.registeredTypes];this._locked=!1;this.generateSlots(this._maxSlots)}getMaxDistance(){return this._maxDistance}getSlot(a){return this._slots[a]?this._slots[a]:void 0}getID(){return this._id}getClient(){return this._client}getStorage(){const a={};for(let b=0;b<this._maxSlots;b++)a[b]=this.getSlot(b)._item;return a}get storage(){return this.getStorage()}generateSlots(a){for(let b=
0;b<a;b++)this._slots[b]=new f(b),this._slots[b]._parent=this}isGlobal(){return this._global}isMaxed(){let a=!0;for(let b=0;b<this._maxSlots;b++)if(!this.getSlot(b).hasItem()){a=!1;break}return a}getOpenSlot(){let a;for(let b=0;b<this._maxSlots;b++)if(!this.getSlot(b).hasItem()){a=b;break}return a}registerType(a){VYLO.Type.isType(a)?this._registeredTypes.includes(a)||this._registeredTypes.push(a):console.warn("EInventory: This is not a valid type. Registration failed")}unRegisterType(a){this._registeredTypes.includes(a)&&
this._registeredTypes.splice(this._registeredTypes.indexOf(a),1)}isLocked(){return this._locked}lock(){this._locked=!0}unlock(){this._locked=!1}canSendItemInfo(){return this._sendItemInfo}static addItemToMap(a,b,d,g,h,k){a=VYLO.newDiob(a);h&&(a.itemInfo=h);k&&(a.quantity=k);a.setPos(b,d,g);if("function"===typeof a.onDropped)a.onDropped()}static removeItemFromMap(a){if("function"===typeof a.onPickup)a.onPickup();VYLO.delDiob(a)}authenticateItemRequest(a){this.obtain(a)}isEligibleType(a){let b=!1;for(const d of this._registeredTypes)if(VYLO.Type.isType(a,
d)){b=!0;break}return this._registeredTypes.includes(a)||b?!0:(console.error("EInventory: This type("+a+") is not of a registered type with this inventory."),!1)}isEligibleItem(a){if(a){if(!a.obtainable)return console.error("EInventory: This item("+a.id+") is not obtainable."),!1;if(!this.isEligibleType(a.type))return!1;if(this.isMaxed()&&!a.quantity)return console.error("EInventory: %cpNo available slots","font-weight: bold"),!1;if(VYLO.Map.getDist(this.getClient().mob,a)>this.getMaxDistance())return console.error("EInventory: This item("+
a.id+") is out of range."),!1}else return console.error("EInventory: No item passed!"),!1;return!0}obtain(a){(a=VYLO.World.getDiobByID(a))&&this.isEligibleItem(a)&&this.addItem(a)}addItem(a){if(this.isLocked())console.warn("EInventory: This inventory is currently locked. Unlock it to pick up this item");else{var b=a.type,d=a.quantity,g=a.itemInfo?a.itemInfo:VYLO.Type.getVariable(b,"itemInfo")?VYLO.Type.getVariable(b,"itemInfo"):VYLO.Type.getStaticVariable(b,"itemInfo"),h={0:a.id};d&&(h[1]=d);g&&this.canSendItemInfo()&&
(h[2]=g);for(var k in this._slots)if(this.getSlot(k).getItemType()===b){const l=this.getSlot(k).getItemQuantity();if(d){const m=a.maxQuantity?a.maxQuantity:VYLO.Type.getVariable(b,"maxQuantity")?VYLO.Type.getVariable(b,"maxQuantity"):VYLO.Type.getStaticVariable(b,"maxQuantity")?VYLO.Type.getStaticVariable(b,"maxQuantity"):1;if(l!==m){if(l+d>m){b=Math.max(l+d-m,1);this.getSlot(k)._item.quantity=Math.max(l,Math.min(l+d,m));h[1]=this.getSlot(k)._item.quantity;g&&(this.getSlot(k)._item.itemInfo=g);if("function"===
typeof this.getClient().onNetwork)this.getClient().onNetwork("EInventory","addItem",[[this.getID(),h,k]]);a.quantity=b;this.addItem(a)}else{this.getSlot(k)._item.quantity=Math.max(l,Math.min(l+d,m));h[1]=this.getSlot(k)._item.quantity;g&&(this.getSlot(k)._item.itemInfo=g);if("function"===typeof this.getClient().onNetwork)this.getClient().onNetwork("EInventory","addItem",[[this.getID(),h,k]]);e.removeItemFromMap(a)}return}}}if(this.isMaxed())console.error("EInventory: %cpNo available slots","font-weight: bold");
else{k=this.getOpenSlot();this.getSlot(k)._item.type=b;d&&(this.getSlot(k)._item.quantity=d);g&&(this.getSlot(k)._item.itemInfo=g);if("function"===typeof this.getClient().onNetwork)this.getClient().onNetwork("EInventory","addItem",[[this.getID(),h,k]]);e.removeItemFromMap(a)}}}discardQuantity(a,b){const d=this.getSlot(a).getItemQuantity();!d&&!b||!d||b>=d?this.getSlot(a).wipe():this.getSlot(a)._item.quantity=Math.max(d-b,1)}removeQuantity(a,b){this.discardQuantity(a,b);if("function"===typeof this.getClient().onNetwork)this.getClient().onNetwork("EInventory",
"removeQuantity",[[this.getID(),a,b]])}removeItem(a,b){if(this.isLocked())console.warn("EInventory: This inventory is currently locked. Unlock it to remove this item");else{var d=this.getSlot(a).getItemInfo(),g=this.getSlot(a).getItemQuantity();if(!(g&!b)){b=Math.max(g?1:0,Math.min(b,g));g=Math.max(g?1:0,Math.min(g?b:0,g));var h=this.getSlot(a).getItemType();(VYLO.Type.getVariable(h,"dissapearOnDrop")?VYLO.Type.getVariable(h,"dissapearOnDrop"):VYLO.Type.getStaticVariable(h,"dissapearOnDrop"))||e.addItemToMap(h,
this.getClient().mob.xPos,this.getClient().mob.yPos,this.getClient().mob.mapName,d,g);this.discardQuantity(a,b);if("function"===typeof this.getClient().onNetwork)this.getClient().onNetwork("EInventory","removeItem",[[this.getID(),a,b]])}}}moveSlot(a,b,d){this.isLocked()||(b=this.getSlot(b),a=c.getInventoryByID(a)._slots[d],a.getParent().isEligibleType(b.getItemType())&&(d=b.getItem(),b.wipe(),a._item=d))}swapSlots(a,b,d){if(!this.isLocked()&&(b=this.getSlot(b),a=c.getInventoryByID(a)._slots[d],d=
a.getParent(),this.isEligibleType(a.getItemType())&&d.isEligibleType(b.getItemType()))){d=b.getItem();const g=a.getItem();b._item=g;a._item=d}}}c.generateID=function(a=7){const b=function(){let g="";for(let h=0;h<a;h++)g+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return g};let d=b();for(;this.storedIDs.includes(d);)d=b();this.storedIDs.push(d);return d};c.createInventory=function(a,b){if("object"===typeof b&&b.constructor===Object)if(b.interface)if(b.itemAtlasName)if("string"!==
typeof b.slotType)console.error("EInventory: The pSettings.slotType is of the wrong type. Expecting a string. Initialization failed.");else if(b.slotType){if(b.clientVariable){b.sendItemInfo=b.sendItemInfo?1:0;b.global=b.global?1:0;b.denotar||(b.denotar=0);b.disableDefaultDrop&&(b.disableDefaultDrop=1);b.maxSlots="number"!==typeof b.maxSlots?0:Math.round(b.maxSlots);b.maxDistance="number"!==typeof b.maxDistance?0:Math.round(b.maxDistance);Array.isArray(b.slotClassList)||(b.slotClassList=0,console.error("EInventory: The pSettings.slotClassList is not of the Array type."));
if(!Array.isArray(b.registeredTypes))b.registeredTypes=0,console.warn("EInventory: This inventory has no registered types to accept. It will not be able to store anything until a type is registered!");else if(50<b.registeredTypes.length){b.registeredTypes=[];console.error("EInventory: This inventory has TOO MANY registered types to accept. There is a hard limit set because this data has to travel over the network");return}var d=this.generateID();b.id=d;b.client=a;d=new e(b);this.storedInventories[b.id]=
d;if("function"===typeof a.onNetwork)a.onNetwork("EInventory","createInventory",[[b.interface,b.itemAtlasName,b.slotType,b.global,b.maxSlots,b.maxDistance,b.slotClassList,b.registeredTypes,b.denotar,b.id,b.clientVariable,b.disableDefaultDrop]]);return d}console.error("EInventory: pSettings.clientVariable was not found! This is a needed property")}else console.error("EInventory: pSettings.slotType was not found! This is a needed property");else console.error("EInventory: The pSettings.itemAtlasName string could not be found. Initialization failed.");
else console.error("EInventory: The pSettings.interface string could not be found. Initialization failed.");else console.warn("EInventory: Invalid type passed for pSettings")};c.getInventoryByID=function(a){return this.storedInventories[a]};c.isHoldingItem=function(){return this.grabbing?!0:!1};c.toggleDebug=function(){this.debugging=!this.debugging}})();